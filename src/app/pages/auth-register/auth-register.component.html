<div class="auth-main" [formGroup]="form">
  <div class="auth-wrapper v3">
    <div class="auth-form">
      <div class="auth-header">
        <a href="javascript:" class="b-brand">
          <img src="assets/images/logo.png" alt="theme-logo" class="logo logo-dark logo-lg" />
        </a>
      </div>

      <div class="my-5">
        <!-- Photographer / Veteran Toggle -->
        <div class="d-flex justify-content-center mb-2">
          <button
            type="button"
            class="btn"
            [ngClass]="{ 'btn-primary': userType === 'photographer', 'btn-outline-primary': userType !== 'photographer' }"
            (click)="setUserType('photographer')"
            style="width: 50%"
          >
            Photographer
          </button>
          <button
            type="button"
            class="btn ms-2"
            [ngClass]="{ 'btn-primary': userType === 'veteran', 'btn-outline-primary': userType !== 'veteran' }"
            (click)="setUserType('veteran')"
            style="width: 50%"
          >
            Veteran
          </button>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-end mb-4">
              <h3 class="mb-0"><b>Sign up</b></h3>
              <a [routerLink]="['/login']" class="link-primary">Already have an account?</a>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label class="form-label" for="firstName">
                    First Name
                    <span class="text-danger">*</span>
                  </label>
                  <input
                    id="firstName"
                    type="text"
                    class="form-control"
                    formControlName="firstName"
                    placeholder="First Name"
                    [ngClass]="{ 'is-invalid': isFormInvalid(form, 'firstName') }"
                    [disabled]="submitting"
                  />
                  <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'firstName')">First name is required.</div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label class="form-label" for="lastName">
                    Last Name
                    <span class="text-danger">*</span>
                  </label>
                  <input
                    id="lastName"
                    type="text"
                    class="form-control"
                    formControlName="lastName"
                    placeholder="Last Name"
                    [ngClass]="{ 'is-invalid': isFormInvalid(form, 'lastName') }"
                    [disabled]="submitting"
                  />
                  <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'lastName')">Last name is required.</div>
                </div>
              </div>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="email">
                Email Address
                <span class="text-danger">*</span>
              </label>
              <input
                id="email"
                type="email"
                class="form-control"
                formControlName="email"
                placeholder="Email Address"
                [ngClass]="{ 'is-invalid': isFormInvalid(form, 'email') }"
                [disabled]="submitting"
              />
              <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'email')">
                {{ isFormError(form, 'email', 'email') ? 'Enter a valid email.' : 'Email is required.' }}
              </div>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="password">
                Password
                <span class="text-danger">*</span>
              </label>
              <input
                id="password"
                type="password"
                class="form-control"
                formControlName="password"
                placeholder="Password"
                [ngClass]="{ 'is-invalid': isFormInvalid(form, 'password') }"
                [disabled]="submitting"
              />
              <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'password')">
                {{ isFormError(form, 'password', 'minlength') ? 'Min 6 characters.' : 'Password is required.' }}
              </div>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="passwordConfirm">
                Confirm Password
                <span class="text-danger">*</span>
              </label>
              <input
                id="passwordConfirm"
                type="password"
                class="form-control"
                formControlName="passwordConfirm"
                placeholder="Confirm Password"
                [disabled]="submitting"
              />
              <small
                class="text-danger"
                *ngIf="form.errors?.['passwordsMismatch'] && (f['passwordConfirm'].touched || f['password'].touched)"
              >
                Passwords do not match
              </small>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="phoneNumber">
                Phone Number
                <span class="text-danger">*</span>
              </label>
              <input
                id="phoneNumber"
                type="tel"
                class="form-control"
                formControlName="phoneNumber"
                placeholder="Phone Number"
                [ngClass]="{ 'is-invalid': isFormInvalid(form, 'phoneNumber') }"
                [disabled]="submitting"
              />
              <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'phoneNumber')">Phone number is required.</div>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="streetAddress1">
                Street Address
                <span class="text-danger">*</span>
              </label>
              <input
                id="streetAddress1"
                type="text"
                class="form-control"
                formControlName="streetAddress1"
                placeholder="Street Address"
                [ngClass]="{ 'is-invalid': isFormInvalid(form, 'streetAddress1') }"
                [disabled]="submitting"
              />
              <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'streetAddress1')">Street address is required.</div>
            </div>

            <div class="form-group mb-3">
              <label class="form-label" for="streetAddress2">Street Address Line 2</label>
              <input
                id="streetAddress2"
                type="text"
                class="form-control"
                formControlName="streetAddress2"
                placeholder="Street Address Line 2"
                [disabled]="submitting"
              />
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label class="form-label" for="city">City</label>
                  <input id="city" type="text" class="form-control" formControlName="city" placeholder="City" [disabled]="submitting" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label class="form-label" for="state">State</label>
                  <select id="state" class="form-select" formControlName="state" [disabled]="submitting">
                    <option [ngValue]="''">--</option>
                    <option *ngFor="let state of usStates" [ngValue]="state">{{ state }}</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="row align-items-end">
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <label class="form-label" for="postalCode">Postal / Zip Code</label>
                  <input
                    id="postalCode"
                    type="text"
                    class="form-control"
                    formControlName="postalCode"
                    placeholder="Postal / Zip Code"
                    [disabled]="submitting"
                  />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group mb-3">
                  <button
                    type="button"
                    class="btn btn-outline-primary w-100"
                    (click)="verifyAddress()"
                    [disabled]="submitting || verifying"
                  >
                    Verify Address
                  </button>
                </div>
              </div>
            </div>

            <div *ngIf="verifying" class="text-center mb-3">
              <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>

            <ng-container *ngIf="!verifying && suggestions.length > 0">
              <div class="form-group mb-3">
                <label class="form-label">
                  Select your exact address:
                  <span class="text-danger">*</span>
                </label>
                <select class="form-select" (change)="selectAddress($event)">
                  <option value="">-- Select --</option>
                  <option *ngFor="let sug of suggestions; let i = index" [value]="i">{{ sug.displayName }}</option>
                </select>
              </div>
            </ng-container>

            <ng-container *ngIf="selectedDisplay">
              <p class="text-muted">Selected Address: {{ selectedDisplay }}</p>
            </ng-container>

            <div class="row mb-3">
              <div class="col-md-6">
                <div class="form-group">
                  <label class="form-label" for="latitude">
                    Latitude
                    <span class="text-danger">*</span>
                  </label>
                  <input
                    id="latitude"
                    type="number"
                    class="form-control"
                    formControlName="latitude"
                    placeholder="Latitude"
                    [ngClass]="{ 'is-invalid': isFormInvalid(form, 'latitude') }"
                    [readonly]="true"
                    [disabled]="submitting"
                  />
                  <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'latitude')">Latitude is required.</div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label class="form-label" for="longitude">
                    Longitude
                    <span class="text-danger">*</span>
                  </label>
                  <input
                    id="longitude"
                    type="number"
                    class="form-control"
                    formControlName="longitude"
                    placeholder="Longitude"
                    [ngClass]="{ 'is-invalid': isFormInvalid(form, 'longitude') }"
                    [readonly]="true"
                    [disabled]="submitting"
                  />
                  <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'longitude')">Longitude is required.</div>
                </div>
              </div>
            </div>

            <div class="text-danger" *ngIf="isFormInvalid(form, 'latitude') && f['streetAddress1'].value">
              Please verify and select your address.
            </div>

            <!-- Photographer-Specific -->
            <div class="form-group mb-3" *ngIf="userType === 'photographer'">
              <label class="form-label" for="website">
                Link To Professional Portfolio
                <span class="text-danger">*</span>
              </label>
              <input
                id="website"
                type="text"
                class="form-control"
                formControlName="website"
                placeholder="Link To Professional Portfolio"
                [ngClass]="{ 'is-invalid': isFormInvalid(form, 'website') }"
                [disabled]="submitting"
              />
              <div class="invalid-feedback" *ngIf="isFormInvalid(form, 'website')">Portfolio link is required for photographers.</div>
            </div>

            <!-- Veteran-Specific -->
            <ng-container *ngIf="userType === 'veteran'">
              <div class="form-group mb-3">
                <label class="form-label">
                  Are You Currently Seeking Employment?
                  <span class="text-danger">*</span>
                </label>
                <div class="form-check form-check-inline">
                  <input
                    id="seekYes"
                    class="form-check-input"
                    type="radio"
                    [value]="true"
                    formControlName="seekingEmployment"
                    [disabled]="submitting"
                  />
                  <label class="form-check-label" for="seekYes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    id="seekNo"
                    class="form-check-input"
                    type="radio"
                    [value]="false"
                    formControlName="seekingEmployment"
                    [disabled]="submitting"
                  />
                  <label class="form-check-label" for="seekNo">No</label>
                </div>
                <div class="invalid-feedback d-block" *ngIf="isFormInvalid(form, 'seekingEmployment')">Please choose Yes or No.</div>
              </div>

              <div class="form-group mb-3">
                <label class="form-label" for="linkedinProfile">LinkedIn Profile</label>
                <input
                  id="linkedinProfile"
                  type="url"
                  class="form-control"
                  formControlName="linkedinProfile"
                  placeholder="LinkedIn Profile"
                  [disabled]="submitting"
                />
              </div>

              <div class="form-group mb-3">
                <label class="form-label">
                  Please Select Your Eligibility
                  <span class="text-danger">*</span>
                </label>
                <div class="form-check">
                  <input
                    id="tsm"
                    class="form-check-input"
                    type="radio"
                    [value]="Eligibility.TRANSITIONING_SERVICE_MEMBER"
                    formControlName="eligibility"
                    [disabled]="submitting"
                  />
                  <label class="form-check-label" for="tsm">Transitioning Service Member</label>
                </div>
                <div class="form-check">
                  <input
                    id="gsfm"
                    class="form-check-input"
                    type="radio"
                    [value]="Eligibility.GOLD_STAR_FAMILY_MEMBER"
                    formControlName="eligibility"
                    [disabled]="submitting"
                  />
                  <label class="form-check-label" for="gsfm">Gold Star Family Member</label>
                </div>
                <div class="form-check">
                  <input
                    id="spouse"
                    class="form-check-input"
                    type="radio"
                    [value]="Eligibility.MILITARY_SPOUSE"
                    formControlName="eligibility"
                    [disabled]="submitting"
                  />
                  <label class="form-check-label" for="spouse">Military Spouse</label>
                </div>
                <div class="invalid-feedback d-block" *ngIf="isFormInvalid(form, 'eligibility')">Please select your eligibility.</div>
              </div>

              <div class="form-group mb-3">
                <label class="form-label">
                  Military Branch Affiliation
                  <span class="text-danger">*</span>
                </label>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-check">
                      <input
                        id="airforce"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_AIR_FORCE"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="airforce">US Air Force</label>
                    </div>
                    <div class="form-check">
                      <input
                        id="army"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_ARMY"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="army">US Army</label>
                    </div>
                    <div class="form-check">
                      <input
                        id="coastguard"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_COAST_GUARD"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="coastguard">US Coast Guard</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-check">
                      <input
                        id="navy"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_NAVY"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="navy">US Navy</label>
                    </div>
                    <div class="form-check">
                      <input
                        id="marine"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_MARINE_CORPS"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="marine">US Marine Corps</label>
                    </div>
                    <div class="form-check">
                      <input
                        id="spaceforce"
                        class="form-check-input"
                        type="radio"
                        [value]="MilitaryBranchAffiliation.US_SPACE_FORCE"
                        formControlName="militaryBranchAffiliation"
                        [disabled]="submitting"
                      />
                      <label class="form-check-label" for="spaceforce">US Space Force</label>
                    </div>
                  </div>
                  <div class="invalid-feedback d-block" *ngIf="isFormInvalid(form, 'militaryBranchAffiliation')">
                    Please select your branch.
                  </div>
                </div>
              </div>

              <div class="form-group mb-3">
                <label class="form-label" for="militaryETSDate">
                  Military ETS Date
                  <span class="text-danger">*</span>
                </label>
                <input
                  id="militaryETSDate"
                  type="date"
                  class="form-control"
                  formControlName="militaryETSDate"
                  [ngClass]="{ 'is-invalid': isFormInvalid(form, 'militaryETSDate') }"
                  [disabled]="submitting"
                />
                <div class="invalid-feedback d-block" *ngIf="isFormInvalid(form, 'militaryETSDate')">Please select Military ETS Date.</div>
              </div>

              <div class="form-check mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="certified"
                  formControlName="certified"
                  [ngClass]="{ 'is-invalid': isFormInvalid(form, 'certified') }"
                  [disabled]="submitting"
                />
                <label class="form-check-label" for="certified">
                  I certify that I am in the transition phase of my honorable military career, a job seeking military spouse, or a Gold Star
                  family member. I am not a gainfully employed veteran.
                  <span class="text-danger">*</span>
                </label>
                <div class="invalid-feedback d-block" *ngIf="isFormInvalid(form, 'certified')">This certification is required.</div>
              </div>
            </ng-container>

            <div class="form-group mb-3">
              <label class="form-label" for="referredBy">Were you referred by anyone?</label>
              <input
                id="referredBy"
                type="text"
                class="form-control"
                formControlName="referredBy"
                placeholder="Were you referred by anyone?"
                [disabled]="submitting"
              />
            </div>

            <p class="mt-4 text-sm text-muted">
              By Signing up, you agree to our
              <a href="javascript:" class="text-primary">Terms of Service</a>
              and
              <a href="javascript:" class="text-primary">Privacy Policy</a>
            </p>

            <div class="d-grid mt-3">
              <button type="button" class="btn btn-primary" (click)="submit()" [disabled]="submitting">
                {{ submitting ? 'Creating...' : 'Create Account' }}
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="auth-footer row">
        <div class="col my-1">
          <p class="m-0">
            Copyright ©
            <a href="javascript:">Portraits for Patriots</a>
          </p>
        </div>
        <div class="col-auto my-1">
          <ul class="list-inline footer-link mb-0">
            <li class="list-inline-item"><a href="javascript:">Home</a></li>
            <li class="list-inline-item"><a href="javascript:">Privacy Policy</a></li>
            <li class="list-inline-item"><a href="javascript:">Contact us</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
